!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):t.jQuery)}(this,function(t){"use strict";t.fn.cleverInfiteScroll=function(e){var n={contentsWrapperSelector:"#contentsWrapper",contentSelector:".content",nextSelector:"#next"},o=t.extend(n,e),i=function(t,e){return"<span class='hidden-title' style='display:none'>"+t+"</span><span class='hidden-url' style='display:none'>"+e+"</span>"},r=function(e,n){history.pushState(null,e,n),t("title").html(e)},c=function(e){var n=t(e).children(".hidden-title:first").text(),o=t(e).children(".hidden-url:first").text();t("title").text()!==n&&r(n,o)},l=t("title").text(),d=t(location).attr("href"),s=t(document).height(),a="undefined"!=typeof window.outerHeight?Math.max(window.outerHeight,t(window).height()):t(window).height(),u=a,f=t(o.contentSelector);t(o.contentSelector+":last").append(i(l,d)),r(l,d);var h,p=0;return t(window).scroll(function(){if(window.clearTimeout(t.data("this","scrollTimer")),t.data(this,"scrollTimer",window.setTimeout(function(){h=t(window).scrollTop(),h>p?f.each(function(e,n){return t(n).offset().top+t(n).height()>h?(c(n),!1):void 0}):p>h&&f.each(function(e,n){return t(n).offset().top+t(n).height()-a/2>h?(c(n),!1):void 0}),p=h},200)),t(window).scrollTop()+a+u>=s){var e=[t(o.nextSelector).attr("href")];t(o.nextSelector).remove(),void 0!==e[0]&&t.ajax({url:e[0],dataType:"html",success:function(n){l=t(n).filter("title").text(),d=e[0],t(o.contentsWrapperSelector).append(t(n).find(o.contentSelector).append(i(l,d))).append(t(n).find(o.nextSelector)),s=t(document).height(),f=t(o.contentSelector)}})}}),this}});
