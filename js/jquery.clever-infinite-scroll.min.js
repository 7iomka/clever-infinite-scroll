!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):e.jQuery)}(this,function(e){"use strict";e.fn.cleverInfiniteScroll=function(t){var n={contentsWrapperSelector:"#contentsWrapper",contentSelector:".content",nextSelector:"#next",loadImage:""},o=e.extend(n,t),i=function(e,t){return"<span class='hidden-title' style='display:none'>"+e+"</span><span class='hidden-url' style='display:none'>"+t+"</span>"},r=function(t,n){history.pushState(null,t,n),e("title").html(t)},c=function(t){var n=e(t).children(".hidden-title:first").text(),o=e(t).children(".hidden-url:first").text();e("title").text()!==n&&r(n,o)},l=e("title").text(),d=e(location).attr("href"),a=e(document).height(),s="undefined"!=typeof window.outerHeight?Math.max(window.outerHeight,e(window).height()):e(window).height(),p=s,f=e(o.contentSelector);e(o.contentSelector+":last").append(i(l,d)),r(l,d);var u,h=0;return e(window).scroll(function(){if(window.clearTimeout(e.data("this","scrollTimer")),e.data(this,"scrollTimer",window.setTimeout(function(){u=e(window).scrollTop(),u>h?f.each(function(t,n){return e(n).offset().top+e(n).height()>u?(c(n),!1):void 0}):h>u&&f.each(function(t,n){return e(n).offset().top+e(n).height()-s/2>u?(c(n),!1):void 0}),h=u},200)),e(window).scrollTop()+s+p>=a){var t=[e(o.nextSelector).attr("href")];e(o.nextSelector).remove(),void 0!==t[0]&&(""!==o.loadImage&&e(o.contentsWrapperSelector).append("<img src='"+o.loadImage+"' id='cis-load-img'>"),e.ajax({url:t[0],dataType:"html",success:function(n){l=e(n).filter("title").text(),d=t[0],e(o.contentsWrapperSelector).append(e(n).find(o.contentSelector).append(i(l,d))),0===e(n).find(o.contentSelector).find(o.nextSelector).length&&e(o.contentsWrapperSelector).append(e(n).find(o.nextSelector)),a=e(document).height(),f=e(o.contentSelector),e("#cis-load-img").remove()}}))}}),this}});
